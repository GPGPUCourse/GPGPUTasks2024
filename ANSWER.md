# 1

Первый сигнал реализовать значительно проще, так как каждое значение `y1[n]` зависит только он `x` и может быть вычислено независимо от других значений. Второй сигнал зависит от своих предыдущих значений, что делает его параллелизацию сложнее. Каждый пересчет `y2[n]` будет требовать синхронизации потоков, что снизит производительность.

Если имелось в виду, что `y2` надо вычислять вне зависимости от предыдущих значений (то есть `y2` тоже дан на входе и мы как будто делаем вычисление атомарно для всего `y2`), то второй сингал становится не сильно сложнее первого, и лишь требует дополнительной синхронизации.

# 2

В такой модели в `i`-м потоке варпа `idx` вычисляется в `k + 32 * i`, где `k` - какое-то фиксированное число, значит `idx % 32 = k` - константа для всех потоков варпа. Таким образом, code divergence не произойдет.

# 3a

Такое обращение к памяти будет coalesced, так как одновременно варп запрашивает индексы `0 + 32 * k`, `1 + 32 * k`, ..., `31 + 32 * k`, что соответствует одной кеш-линии. Будет совершено 32 записи кеш-линии, по одной на каждое `k`, что соответствует размеру рабочей группы по `y * z`.

# 3b

Такое обращение к памяти не будет coalesced, так как одновременно варп запрашивает индексы `k + 32 * 0`, `k + 32 * 1`, ..., `k + 32 * 31`, что соответствует 32 кеш-линиям. В худшем случае, не опираясь на hardware-кеш, будет совершено 1024 записи кеш-линий, так как каждый инстанс исполнения рабочей группы на варпе запросит все 32 кеш-линии, а всего исполнений будет 32. Но кеш может улучшить ситуацию и уменьшить количество транзакций к глобальной памяти.

# 3c

Такое обращение к памяти не coalesced (но почти coalesced), так как одновременно варп запрашивает индексы `1 + 32 * k`, `2 + 32 * k`, ..., `32 + 32 * k`, и они ложатся в 2 разные кеш-линии (так как данные выровнены по 32 флота). Значит каждое выполнение на варпе части рабочей группы совершит 2 записи, а всего исполнений будет 32, так что всего будет совершено 64 записи кеш-линий.

Хотя я нашел древнюю презентацию, где говориться, что давным-давно было и 32 записи на варпе за раз. [Источник](https://www.nvidia.com/content/GTC/documents/1068_GTC09.pdf#page=17).
